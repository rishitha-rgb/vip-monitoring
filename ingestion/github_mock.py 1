import sys
import os
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from storage.canonical import CanonicalItem, DuckDBStorage
from datetime import datetime

def mock_scrape_github(vip_name):
    storage = DuckDBStorage()
    
    sample_activities = [
        {"handle": "dev1", "content": f"{vip_name} repo issue created", "type": "issue"},
        {"handle": "dev2", "content": f"{vip_name} repo commit made", "type": "commit"}
    ]
    
    for activity in sample_activities:
        item = CanonicalItem(
            source="github",
            vip=vip_name,
            handle=activity["handle"],
            content=activity["content"],
            url=f"https://github.com/{activity['handle']}/repo/12345",
            timestamp=datetime.utcnow(),
            metadata={"activity_type": activity["type"]}
        )
        storage.insert_item(item)
        print(f"Inserted GitHub activity from {activity['handle']}")

if __name__ == "__main__":
    mock_scrape_github("Test VIP")
