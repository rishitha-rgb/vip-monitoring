import sys
import os
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from storage.canonical import CanonicalItem, DuckDBStorage
from datetime import datetime

def mock_scrape_reddit(vip_name):
    storage = DuckDBStorage()
    
    sample_posts = [
        {"handle": "reddit_user1", "content": f"{vip_name} is trending on Reddit!", "upvotes": 120, "comments": 15},
        {"handle": "reddit_user2", "content": f"Discussion about {vip_name}", "upvotes": 80, "comments": 10}
    ]
    
    for post in sample_posts:
        item = CanonicalItem(
            source="reddit",
            vip=vip_name,
            handle=post["handle"],
            content=post["content"],
            url=f"https://reddit.com/user/{post['handle']}/posts/12345",
            timestamp=datetime.utcnow(),
            metadata={"upvotes": post["upvotes"], "comments": post["comments"]}
        )
        storage.insert_item(item)
        print(f"Inserted Reddit post from {post['handle']}")

if __name__ == "__main__":
    mock_scrape_reddit("Test VIP")
