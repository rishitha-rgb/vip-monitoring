from storage.canonical import DuckDBStorage, CanonicalItem

storage = DuckDBStorage()

mock_tweets = [
    {"text": "Hello world", "author": "user1", "likes": 10, "retweets": 2},
    {"text": "VIP monitoring", "author": "user2", "likes": 5, "retweets": 1},
]

for t in mock_tweets:
    item = CanonicalItem(
        text=t["text"],
        author=t["author"],
        source="twitter",
        metadata={"likes": t["likes"], "retweets": t["retweets"]}
    )
    storage.insert_item(item)

print("Mock ingestion completed successfully")
